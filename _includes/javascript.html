<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

{% if page.url == "/" %}
<script>
$(function() {
  $(".home-content div").each(function() {
    $(this).find("p").first().addClass("drop-caps");
  });
});
</script>
{% endif %}

{% if page.title == "University" %}
<script>

/*
 * Step 1: build our data structure out from collections/_logs/*.md so JS can access.
 */
var university = [];
{% assign logs = site.logs | sort: "id" %}
{% for log in logs %}
  var o_{{ log.content_id }} = {};
  o_{{ log.content_id }}["content_id"] = {{ log.content_id }};
  o_{{ log.content_id }}["author"] = "{{ log.author }}";
  o_{{ log.content_id }}["ascii"] = "{{ log.ascii }}";
  o_{{ log.content_id }}["x"] = {{ log.x }};
  o_{{ log.content_id }}["y"] = {{ log.y }};
  o_{{ log.content_id }}["class"] = "{{ log.class }}";

  var a = [];
  {% for attribute in log.attributes %}
    a.push("{{ attribute }}");
  {% endfor %}
  o_{{ log.content_id }}["attr"] = a;

  university.push(o_{{ log.content_id }});
{% endfor %}

console.log(university);

/*
 * Step 2: make the map.
 */
function makeGrid(x, y) {
  var out = "";
  for (var iy = y - 1; iy >= 0; iy--) {
    var cells = "";
    for (var ix = x - 1; ix >= 0; ix--) {
      var className = "x" + ix + "y" + iy;
      cells += makeCell(className);
    }
    out += makeRow(cells);
  }
  return out;
}

function makeRow(cells) {
  return '<div class="longitude">' + cells + "</div>";
}

function makeCell(className) {
  return '<div class="cell ' + className + '">.</div>';
}

if (document.getElementById("university")) {
  document.getElementById("university").innerHTML = makeGrid(32, 16);
}

/*
 * Step 3: profit.
 */

// loop through university
// get x and y
// inject ascii character
// inject css class
// simulate clicks $("[data-content-id='" + content_id + "']").click();


/*
 * Left content area. Sorry for the jQuery. ¯\_(ツ)_/¯
 */
function show_content(content_id) {
  $("a.log-nav").each(function() { $(this).removeClass("active"); });
  $("a.log-nav[data-content-id='" + content_id + "']").addClass("active");
  $(".log-content").each(function() { $(this).hide() });
  $(".log-"+ content_id).show();
}

function isLocal(url) {
  /*
  - get host of url + current location
  - check if same
  - then we can do clicky things
  */
}

$(function() {
  // Log main navigation.
  $("a.log-nav").click(function() {
    show_content($(this).data("content-id"))
  });

  // Inline log navigation.

  $("a").click(function() {
    ///debugger;
    var content_id = $(this).attr("href").split("#")[1];
    if (content_id != null) {
      show_content(content_id);
    }
  });

  // Set the initial log view based on the anchor in the URL.
  var content_id = window.location.hash.substr(1) === "" ? 1 : window.location.hash.substr(1);
  $("[data-content-id='" + content_id + "']").click();

  /*
   * Make all post images link to high res versions of themsleves.
   * The other options besides JS were to do it in markdown which is an awful author/writing
   * experience or extend Jekyll to do this during compilation. This is 3 lines.
   */
  $(".log-content img").each(function() {
    $(this).wrap('<a href="' + this.src + '"></a>');
  });

  /*
   * Make the first letter big.
   */
  $(".log-content").each(function() {
    $(this).find("p").first().addClass("drop-caps");
  });

});

</script>
{% endif %}

<!-- this was intended for for global js, but do whatever you need to -->
<script src="{{ "/assets/javascript/script.js" | relative_url }}?{{site.time | date: '%s%N'}}"></script>