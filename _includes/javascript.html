<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

{% if page.url == "/" %}
<script>
$(function() {
  $(".home-content div").each(function() {
    $(this).find("p").first().addClass("drop-caps");
  });
});
</script>
{% endif %}

{% if page.title == "University" %}
<script>

/*
 * Step 1: build our data structure out from collections/_posts/*.md so JS can access.
 */
var posts = [];
{% for post in site.posts | sort: "content_id" %}
  var post_{{ post.content_id }} = {};
  post_{{ post.content_id }}["date"] = "{{ post.date }}";
  post_{{ post.content_id }}["layout"] = "{{ post.layout }}";
  post_{{ post.content_id }}["url"] = "{{ post.url }}";
  post_{{ post.content_id }}["content_id"] = {{ post.content_id }};
  post_{{ post.content_id }}["author"] = "{{ post.author }}";
  post_{{ post.content_id }}["ascii"] = "{{ post.ascii }}";
  post_{{ post.content_id }}["x"] = {{ post.x }};
  post_{{ post.content_id }}["y"] = {{ post.y }};
  post_{{ post.content_id }}["class"] = "{{ post.class }}";
  var attrs = [];
  {% for attribute in post.attributes %}
    attrs.push("{{ attribute }}");
  {% endfor %}
  posts.push(post_{{ post.content_id }});
{% endfor %}

console.log(posts);

/*
 * Step 2: make the map.
 */
function makeGrid(x, y) {
  var out = "";
  for (var iy = y - 1; iy >= 0; iy--) {
    var cells = "";
    for (var ix = x - 1; ix >= 0; ix--) {
      var className = "x" + ix + "y" + iy;
      cells += makeCell(className);
    }
    out += makeRow(cells);
  }
  return out;
}

function makeRow(cells) {
  return '<div class="longitude">' + cells + "</div>";
}

function makeCell(className) {
  return '<div class="cell ' + className + '">.</div>';
}

if (document.getElementById("university")) {
  document.getElementById("university").innerHTML = makeGrid(30, 6);
}

/*
 * Step 3: profit.
 */

// loop through univeristy
// get x and y
// inject ascii character
// inject css class
// simulate clicks $("[data-content-id='" + content_id + "']").click();


/*
 * Left content area. Sorry for the jQuery. ¯\_(ツ)_/¯
 */
function show_content(content_id) {
    $("a.post-nav").each(function() { $(this).removeClass("active"); });
    $("a.post-nav[data-content-id='" + content_id + "']").addClass("active");
    $(".post-content").each(function() { $(this).hide() });
    $(".post-"+ content_id).show();
}

$(function() {
  // Posts main navigation.
  $("a.post-nav").click(function() {
    show_content($(this).data("content-id"))
  });

  // Inline post navigation.
  $("a").click(function() {
    var content_id = $(this).attr("href").split("#")[1];
    if (content_id != null) {
      show_content(content_id);
    }
  });

  // Set the initial post view based on the anchor in the URL.
  var content_id = window.location.hash.substr(1) == "" ? 1 : window.location.hash.substr(1);
  $("[data-content-id='" + content_id + "']").click();

  /*
   * Make all post images link to high res versions of themsleves.
   * The other options besides JS were to do it in markdown which is an awful author/writing
   * experience or extend Jekyll to do this during compilation. This is 3 lines.
   */
  $(".post-content img").each(function() {
    $(this).wrap('<a href="' + this.src + '"></a>');
  });

  /*
   * Make the first letter big.
   */
  $(".post-content").each(function() {
    $(this).find("p").first().addClass("drop-caps");
  });

});

</script>
{% endif %}

<!-- this was intended for for global js, but do whatever you need to -->
<script src="{{ "/assets/javascript/script.js" | relative_url }}?{{site.time | date: '%s%N'}}"></script>